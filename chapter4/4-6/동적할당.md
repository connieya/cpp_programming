# 동적 할당

자료 저장을 위해 기억 장소를 할당하는 방법에는 정적 할당과 동적 할당이 있다.
정적 할당은 앞서 살펴본 변수의 선언 방식을 말한다. 변수를 선언하면 자료 저장을 위한
기억 장소가 할당된다. 프로그램 실핼 전에 필요한 기억 장소가 미리 할당된 상태에서
프로그램 동작이 시작되므로 '정적'이라 한다.

그렇다면 '동적'은 미리 할당되지 않는 것을 말하는가?
그렇다. 동적 할당은 프로그램  실행 중에 필요한 만큼 기억 장소를 요청하는 것이다.
동적 할당은 기억 장소를 할당하고 할당된 기억 장소의 주소를 포인터 변수에 저장하면 되는 것이다.
이때 기억 장소 할당을 위해 new 연산자를 사용한다. 

```c++
자료형 * 포인터 변수 = new 자료형[개수];
```
필요한 기억 장소가 하나인 경우 '[개수]'는 생략한다. 동적 할당으로 확보한 기억 장소는
모두 사용하고 나서 그만 사용하겠다고 해제해야 한다. 해제에 사용되는 명령은 delete 이다.

```c++
delete 포인터 변수; // 하나의 기억 장소 해제 시
delete [] 포인터 변수; // 여러 개의 기억 장소 해제 시
```

```c++
#include <iostream>

using namespace ::std;

int main() {
    int *pi = new int;

    *pi = 100;

    cout << *pi << endl;

    delete pi;

    int *pj = new int[3];
    pj[0] = 10;
    pj[1] = 20;
    pj[2] = 30;

    for (int i = 0; i < 3; ++i) {
        cout << pj[i] << endl;
    }

    delete [] pj;

    return 0;
}
```

기억 장소를 더 이상 사용하지 않을 때는 반드시 해제해야 한다, 그 이유는
앞서 배웠던 일반 변수, 포인터 변수, 배열 변수, 레퍼런스 변수 등 정적으로 할당된
변수들은 컴퓨터 기억 장소 중에 스택에 할당되는 반면 동적 할당은 힙에 할당되기 때문이다.
기억 장소가 할당되는 위치가 다른 이유는 할당된 기억 장소가 프로그램 시작과 종료를 기준으로
얼마나 지속 되는가를 판단하기 때문이다. 힙에 할당되면 delete를 이용해서 해제 하지 않으면
프로그램이 종료될 때까지 지속된다.

|할당 | 할당 방법 | 할당 장소 | 기억 장소 확보 시기 | 기억 장소 해제 시기
|:---|:----|:----|:-----|:----|
|정적 할당 | 필요한 자료형 변수 선언 | 스택(Stack) | 변수가 선언된 함수가 호출될 때 | 변수가 선언된 함수 실행이 종료 될 때
|동적 할당 | new 연산자 이용 | 힙(Heap) | 동적 할당 코드가 실행될 때 | delete 명령이 실행 될 때, 만약 delete 명령이 실행되지 않으면 프로그램이 종료 될 때